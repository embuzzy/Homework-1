---
title: "HClust Example"
author: "Emily Buzzelli"
date: "August 8, 2018"
output: html_document
---

```
# Protein first
protein <- read.csv("protein.csv", row.names=1)

# Center/scale the data
protein_scaled <- scale(protein, center=TRUE, scale=TRUE) 

# Form a pairwise distance matrix using the dist function
protein_distance_matrix = dist(protein_scaled, method='euclidean')


# Now run hierarchical clustering
hier_protein = hclust(protein_distance_matrix, method='average')


# Plot the dendrogram
plot(hier_protein, cex=0.8)

# Cut the tree into 5 clusters
cluster1 = cutree(hier_protein, k=5)
summary(factor(cluster1))

# Examine the cluster members
which(cluster1 == 1)
which(cluster1 == 2)
which(cluster1 == 3)


# Using single ("single") linkage instead
hier_protein2 = hclust(protein_distance_matrix, method='complete')

# Plot the dendrogram
plot(hier_protein2, cex=0.8)
cluster2 = cutree(hier_protein2, k=5)
summary(factor(cluster2))

# Examine the cluster members
which(cluster2 == 1)
which(cluster2 == 2)
which(cluster2 == 3)


## Now the cars data
cars = read.csv('../data/cars.csv', header=TRUE)

summary(cars)

# Center and scale the data
X = cars[,-(1:9)]
X = scale(X, center=TRUE, scale=TRUE)

# Extract the centers and scales from the rescaled data (which are named attributes)
mu = attr(X,"scaled:center")
sigma = attr(X,"scaled:scale")

# First form a pairwise distance matrix
distance_between_cars = dist(X)

# Now run hierarchical clustering
h1 = hclust(distance_between_cars, method='complete')

# Cut the tree into 10 clusters
cluster1 = cutree(h1, k=10)
summary(factor(cluster1))

# Examine the cluster members
which(cluster1 == 1)

# Plot the dendrogram
plot(h1, cex=0.3)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
